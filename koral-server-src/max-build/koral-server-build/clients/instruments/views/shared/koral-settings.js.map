{"version":3,"names":["html","css","LitElement","nothing","getValueFromData","setDataFromEvent","KoralSettings","properties","id","type","String","instrument","infos","constructor","_state","settingsTimeout","timeoutDuration","state","onUpdate","requestUpdate","styles","render","e","sendEvent","onBackPress","onBackRelease","clearTimeout","setTimeout","console","log","set","settings","get","customElements","undefined","define"],"sources":["../../../../../src/clients/instruments/views/shared/koral-settings.js"],"sourcesContent":["import { html, css, LitElement, nothing } from 'lit';\nimport '@ircam/sc-components/sc-switch.js';\nimport { getValueFromData, setDataFromEvent } from './utilities.js';\n\nclass KoralSettings extends LitElement {\n  static properties = {\n    id: { type: String },\n    instrument: { type: String },\n    infos: { type: String },\n  };\n\n  constructor() {\n    super();\n    this._state = null;\n    this.settingsTimeout = null;\n    this.timeoutDuration = 500;\n  }\n\n  set state(state) {\n    this._state = state;\n    this._state.onUpdate(() => {\n      this.requestUpdate();\n    });\n    // on state change\n    this.requestUpdate();\n  }\n\n  static styles = css`\n    :host {\n      width: 100%;\n      height: 100%;\n      display: flex;\n      flex-direction: column;\n      gap: 30px;\n    }\n\n    .row {\n      display: flex;\n      width: 100%;\n      flex-direction: row;\n      align-items: center;\n    }\n    .row.around {\n      justify-content: space-around;\n    } \n    .row.between {\n      justify-content: space-between;\n    }\n\n    .column {\n      display: flex;\n      height: 100%;\n      width: 100%;\n      flex-direction: column;\n      align-items: center;\n      justify-content: space-between;\n    }\n    .column.buttons {\n      width: 45%;\n      aspect-ratio: 2/3;\n    }\n    .column.footer {\n      height: var(--koral-footer-button-width);\n    }\n\n    .switch sc-switch {\n      width: var(--koral-settings-switch-width);\n      height: var(--koral-settings-switch-height);\n      border-radius: var(--koral-border-radius);\n      border: var(--koral-color-1) solid;\n    \n      background-color: rgba(0, 0, 0, 0);\n      --sc-switch-transition-time: 75ms;\n      --sc-switch-toggle-color: var(--koral-color-3);\n      --sc-switch-active-color: var(--koral-color-1);\n    }\n\n    .icon {\n      background-position: 50% 50%;\n      background-repeat: no-repeat;\n\n    }\n    .switch .icon {\n      height: calc(1.4 * var(--koral-settings-switch-height));\n      width: var(--koral-settings-switch-width);\n      background-size: calc(0.5 * var(--koral-settings-switch-width));\n    }\n    #divider .icon {\n      height: var(--koral-settings-divider-width);\n      width: var(--koral-settings-divider-width);\n      margin-inline: 10px;\n      background-size: var(--koral-settings-divider-width) var(--koral-settings-divider-width);\n    }\n\n    #divider hr {\n      width: calc((100vw - 2 * var(--koral-horizontal-margin) - var(--koral-settings-divider-width) - 20px) / 2);\n      height: 1px;\n      border: 0;\n      border-top: 1px solid #ccc;\n    }\n\n    .zone {\n      width: 100%;\n      border: none;\n      border-radius: var(--koral-border-radius);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    .zone.set {\n      height: 66%;\n      background-color: var(--koral-color-1);\n      --sc-button-background-color: rgba(0, 0, 0, 0);\n      --sc-button-background-color-hover: rgba(0, 0, 0, 0);\n      --sc-button-background-color-active: rgba(0, 0, 0, 0.5);\n      background-size: calc(0.8 * 0.45 * (100vw - 2 * var(--koral-horizontal-margin)) );\n      background-position: 50% 50%;\n      background-repeat: no-repeat;\n    } \n    .zone.reset {\n      height: 25%;\n      background-color: var(--koral-color-2);\n      --sc-button-background-color: rgba(0, 0, 0, 0);\n      --sc-button-background-color-hover: rgba(0, 0, 0, 0);\n      --sc-button-background-color-active: rgba(0, 0, 0, 0.5);\n      background-size: calc(0.3 * 0.45 * (100vw - 2 * var(--koral-horizontal-margin)) );\n      background-position: 50% 50%;\n      background-repeat: no-repeat;\n    }\n\n    .large-logo {\n      height: var(--koral-footer-button-width);\n      width: calc(var(--koral-footer-logo-ratio) * var(--koral-footer-button-width));\n      background-size: calc(var(--koral-footer-logo-ratio) * var(--koral-footer-button-width)) calc(var(--koral-footer-button-width));\n      background-position: 50% 50%;\n      background-repeat: no-repeat;\n    }\n\n    .footer-zone{\n      height: var(--koral-footer-button-width);\n      width: calc(1.4 * var(--koral-footer-button-width));\n      border: none;\n    }\n    .footer-zone.button {\n      background-size: calc(var(--koral-footer-button-width));\n      background-position: 50% 50%;\n      background-repeat: no-repeat;\n\n      --sc-button-background-color: rgba(0, 0, 0, 0);\n      --sc-button-background-color-hover: rgba(0, 0, 0, 0);\n      --sc-button-background-color-active: rgba(0, 0, 0, 0.5);\n    }\n    .footer-zone.text {\n      color: var(--koral-bg-1);\n      --sc-button-background-color: var(--koral-color-3);\n      --sc-button-background-color-active: var(--koral-color-3);\n      border-radius: 8px;\n      font-size: 24px;\n      font-family: var(--koral-font-family);\n    }\n    `;\n\n  render() {\n    if (!this._state) {\n      return nothing;\n    }\n\n    return html`\n      <div class=\"column\">\n        <div class=\"row around\">\n          <div class=\"column switch\">\n            <div class=\"icon\" style=\"background-image: url(images/settings_quantize.png)\"></div>\n            <sc-switch\n            class=\"setting-switch\"\n            .value=${getValueFromData(this, ['settings', 'kantizer'])}\n            @change=${e => setDataFromEvent(this, ['settings', 'kantizer'], e)}\n            ></sc-switch>\n          </div>\n          <div class=\"column switch\">\n            <div class=\"icon\" style=\"background-image: url(images/settings_legato.png)\"></div>\n            <sc-switch\n            class=\"setting-switch\"\n            .value=${getValueFromData(this, ['settings', 'legato'])}\n            @change=${e => setDataFromEvent(this, ['settings', 'legato'], e)}\n            ></sc-switch>\n          </div>\n        </div>\n        <div class=\"row around\">\n          <div class=\"column switch\">\n          <div class=\"icon\" style=\"background-image: url(images/settings_bolt.png)\"></div>\n            <sc-switch\n            class=\"setting-switch\"\n            .value=${getValueFromData(this, ['settings', 'bolt'])}\n            @change=${e => setDataFromEvent(this, ['settings', 'bolt'], e)}\n            ></sc-switch>\n          </div>\n          <div class=\"column switch\">\n          <div class=\"icon\" style=\"background-image: url(images/settings_move.png)\"></div>\n            <sc-switch\n            class=\"setting-switch\"\n            .value=${getValueFromData(this, ['settings', 'move'])}\n            @change=${e => setDataFromEvent(this, ['settings', 'move'], e)}\n            ></sc-switch>\n          </div>\n        </div>\n        <div class=\"column\" style=\"height:auto\">\n          <div class=\"row around\" id=\"divider\">\n            <hr>\n            <div class=\"icon\" style=\"background-image: url(images/settings_divider.png)\"></div>\n            <hr>\n          </div>\n          <div class=\"row between\">\n            <div class=\"column buttons centered\">\n              <sc-button\n                class=\"zone set \"\n                style=\"background-image: url(images/trajectory.png)\"\n                @input=${e => sendEvent(`${this.instrument}/trajectory/set`, 1)}\n              ></sc-button>\n              <sc-button\n                class=\"zone reset \"\n                style=\"background-image: url(images/undo.png)\"\n                @input=${e => sendEvent(`${this.instrument}/trajectory/reset`, 1)}\n              ></sc-button>\n              </div>\n            <div class=\"column buttons centered\">\n              <sc-button\n                class=\"zone set \"\n                style=\"background-image: url(images/zoneab.png)\"\n                @input=${e => sendEvent(`${this.instrument}/zone/set`, 1)}\n              ></sc-button>\n              <sc-button\n                class=\"zone reset \"\n                style=\"background-image: url(images/undo.png)\"\n                @input=${e => sendEvent(`${this.instrument}/zone/reset`, 1)}\n              ></sc-button>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"column footer\" style=\"justify-content:end\">\n        <div class=\"row around\" style=\"align-items:end\">\n          <sc-button\n            @press=${this.onBackPress}\n            @release=${this.onBackRelease}\n            class=\"footer-zone button\"\n            style=\"background-image: url(images/back.png)\"\n          ></sc-button>\n          <div class=\"large-logo\" style=\"background-image: url(images/large-logo.png)\"></div>\n          <sc-button\n            class=\"footer-zone text\"\n          >${this.id}</sc-button>\n        </div>\n      </div>\n    `;\n  }\n\n  onBackPress() {\n    clearTimeout(this.settingsTimeout);\n    this.settingsTimeout = setTimeout(() => {\n      console.log(\"leaving settings\");\n      this._state.set({ settings: !this._state.get('settings') })\n    }, this.timeoutDuration);\n  }\n\n  onBackRelease() {\n    clearTimeout(this.settingsTimeout);\n  }\n}\n\nif (customElements.get('koral-settings') === undefined) {\n  customElements.define('koral-settings', KoralSettings);\n}\n"],"mappings":"AAAA,SAASA,IAAI,EAAEC,GAAG,EAAEC,UAAU,EAAEC,OAAO,QAAQ,KAAK;AACpD,OAAO,mCAAmC;AAC1C,SAASC,gBAAgB,EAAEC,gBAAgB,QAAQ,gBAAgB;AAEnE,MAAMC,aAAa,SAASJ,UAAU,CAAC;EACrC,OAAOK,UAAU,GAAG;IAClBC,EAAE,EAAE;MAAEC,IAAI,EAAEC;IAAO,CAAC;IACpBC,UAAU,EAAE;MAAEF,IAAI,EAAEC;IAAO,CAAC;IAC5BE,KAAK,EAAE;MAAEH,IAAI,EAAEC;IAAO;EACxB,CAAC;EAEDG,WAAWA,CAAA,EAAG;IACZ,KAAK,CAAC,CAAC;IACP,IAAI,CAACC,MAAM,GAAG,IAAI;IAClB,IAAI,CAACC,eAAe,GAAG,IAAI;IAC3B,IAAI,CAACC,eAAe,GAAG,GAAG;EAC5B;EAEA,IAAIC,KAAKA,CAACA,KAAK,EAAE;IACf,IAAI,CAACH,MAAM,GAAGG,KAAK;IACnB,IAAI,CAACH,MAAM,CAACI,QAAQ,CAAC,MAAM;MACzB,IAAI,CAACC,aAAa,CAAC,CAAC;IACtB,CAAC,CAAC;IACF;IACA,IAAI,CAACA,aAAa,CAAC,CAAC;EACtB;EAEA,OAAOC,MAAM,GAAGnB,GAAG;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A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","ignoreList":[]}
